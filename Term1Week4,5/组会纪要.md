# 组会纪要

## ECG-Based Deep Learning and Clinical Risk Factors to Predict Atrial Fibrillation

- PMID: 34743566
-  
- PMCID: [PMC8748400](http://www.ncbi.nlm.nih.gov/pmc/articles/pmc8748400/)
-  
- DOI: [10.1161/CIRCULATIONAHA.121.057480 ](https://doi.org/10.1161/circulationaha.121.057480)

Circulation，Q1，B1，IF35.5



**方法：**我们训练了一个卷积神经网络（ECG-AI），利用12导联心电图推测在马萨诸塞总医院（MGH）接受长期初级保健的患者5年内新发房颤的风险。

**结论：**基于AI的12导联心电图分析在预测新发房颤风险方面与临床风险因素模型具有相似的实用性，且两种方法具有互补性。

**创新点**

1. 基于人工智能的12导联心电图分析与已建立的房颤（AF）临床风险因素模型具有相似的预测有用性，两者是互补的。
2. AF的ECG人工智能模型在独立研究样本中具有预测有用性，可区分心力衰竭和中风患者的风险，并适用于单导联ECG描记。

**临床意义**

1. 使用12导联ECG的基于人工智能的AF风险预测模型可以有效量化未来的AF风险。
2. AF的预测可以使用临床风险因素或基于人工智能的ECG分析来进行，但两者的组合提供了最大的预测准确性



ECG-AI是一种经过训练的卷积神经网络，用于预测5年无房颤生存率。==ECG-AI的输入是单个12导联ECG（5000 x 12 维的统一输入张量）==

==ECG-AI 采用的不是二元分类法10,11 ，而是编码和损失函数21 ，既考虑了结果（即房颤）发生的时间，也考虑了普查（定义为最早的死亡或随访丢失）带来的遗漏。==为此，==ECG-AI 编码将时间划分为离散的时间段，在这些时间段内，房颤事件或剔除事件均有可能发生，而损失函数优化了每个时间段内预测房颤发生的负对数可能性==。



心电图人工智能的输入是 XML 格式的 12 导联心电图，其中==每个导联表示为 10 秒钟内以 250 或 500Hz 采样的相对电压振幅向量==。采样频率为 250Hz 的心电图被升采样至 500Hz，以实现统一的输入形状。对于在基线窗口内有多个心电图的个体，在每个epoch用于训练的心电图是从该个体的所有心电图中随机选择的。

虽然新发房颤（AF）可以被建模为一个二元分类任务，但==这种方法并未考虑删失（数据不完整性），可能导致样本级别校准不佳==。为了解决这个问题，我们扩展了Gensheimer和Narasimhan提出的方法，==开发并实施了一种编码和损失函数==，该函数同时考虑了由于事件（如AF）和正确的审查所引入的遗漏。==编码将总随访时间划分为n个时间段==，在我们的案例中，n=25，每个时间段跨度约为72天。==每个个体由两个长度为n的二进制向量表示，其中一个表示删除日期的二进制掩码，另一个表示AF事件状态的one-hot编码==。删失向量$V_{\text{censor}}$在个体被删失的时间段中为0，在他们处于风险集中的时间段中为1。事件向量$V_{\text{AF}}$如果在该时间段内发生AF诊断则为1，否则为0。ECG-AI输出长度为n的向量$V_{\text{predict}}$，代表在每个时间段内AF存活的概率。我们的==损失函数最小化了ECG-AI预测的负对数似然==。似然函数分为时间段内幸存个体和发生事件的时间段中的贡献。具体来说，我们最小化以下公式：

$$
L = -\sum \log(L_{\text{survival}} + L_{\text{event}})
$$
其中，

$$
L_{\text{survival}} = 1 - (V_{\text{AF}} * V_{\text{predict}})
$$

$$
L_{\text{event}} = (V_{\text{censor}} * V_{\text{predict}}) + (1 - V_{\text{censor}})
$$

通过这种方式，==删失个体在删失后的时间段中不会对损失做出贡献==（例如，死亡或随访最后时间）。第一个时间段被保留用于记录随访开始前的事件。==该模型为每个时间段预测独立的生存概率（通过sigmoid激活函数）==，因此不假设比例风险，并有助于处理不连续的生存曲线建模。

心电图人工智能==在两个不同的时间尺度（10 秒心电图和 5 年预测生存曲线）之间进行映射==。该映射由==一维卷积神经网络（CNN）==学习，其心电图输入为（5000，12），输出向量为 25 个存活概率，每个时间分段一个。



以下是心电图人工智能的架构概要。简而言之，该模型将 10 秒钟的连续 12 导联心电图波形数据作为第一卷积层的输入。全连接层只接收卷积的心电图波形数据，以生成心房颤动发生时间的估计值（主要）以及年龄、性别和诊断声明中是否存在心房颤动的预测值（次要）。箭头表示各层之间的连接。Conv1D = 一维卷积，MaxPooling1D = 一维最大池化。

## 