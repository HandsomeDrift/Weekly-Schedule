# 组会纪要

## 1. ECG-Based Deep Learning and Clinical Risk Factors to Predict Atrial Fibrillation

- PMID: 34743566
-  
- PMCID: [PMC8748400](http://www.ncbi.nlm.nih.gov/pmc/articles/pmc8748400/)
-  
- DOI: [10.1161/CIRCULATIONAHA.121.057480 ](https://doi.org/10.1161/circulationaha.121.057480)

Circulation，Q1，B1，IF35.5，2022



**方法：**我们训练了一个卷积神经网络（ECG-AI），利用12导联心电图推测在马萨诸塞总医院（MGH）接受长期初级保健的患者5年内新发房颤的风险。

**结论：**基于AI的12导联心电图分析在预测新发房颤风险方面与临床风险因素模型具有相似的实用性，且两种方法具有互补性。

**创新点**

1. 基于人工智能的12导联心电图分析与已建立的房颤（AF）临床风险因素模型具有相似的预测有用性，两者是互补的。
2. AF的ECG人工智能模型在独立研究样本中具有预测有用性，可区分心力衰竭和中风患者的风险，并适用于单导联ECG描记。

**临床意义**

1. 使用12导联ECG的基于人工智能的AF风险预测模型可以有效量化未来的AF风险。
2. AF的预测可以使用临床风险因素或基于人工智能的ECG分析来进行，但两者的组合提供了最大的预测准确性



ECG-AI是一种经过训练的卷积神经网络，用于预测5年无房颤生存率。==ECG-AI的输入是单个12导联ECG（5000 x 12 维的统一输入张量）==

==ECG-AI 采用的不是二元分类法10,11 ，而是编码和损失函数21 ，既考虑了结果（即房颤）发生的时间，也考虑了普查（定义为最早的死亡或随访丢失）带来的遗漏。==为此，==ECG-AI 编码将时间划分为离散的时间段，在这些时间段内，房颤事件或剔除事件均有可能发生，而损失函数优化了每个时间段内预测房颤发生的负对数可能性==。



心电图人工智能的输入是 XML 格式的 12 导联心电图，其中==每个导联表示为 10 秒钟内以 250 或 500Hz 采样的相对电压振幅向量==。采样频率为 250Hz 的心电图被升采样至 500Hz，以实现统一的输入形状。对于在基线窗口内有多个心电图的个体，在每个epoch用于训练的心电图是从该个体的所有心电图中随机选择的。

虽然新发房颤（AF）可以被建模为一个二元分类任务，但==这种方法并未考虑删失（数据不完整性），可能导致样本级别校准不佳==。为了解决这个问题，我们扩展了Gensheimer和Narasimhan提出的方法，==开发并实施了一种编码和损失函数==，该函数同时考虑了由于事件（如AF）和正确的审查所引入的遗漏。==编码将总随访时间划分为n个时间段==，在我们的案例中，n=25，每个时间段跨度约为72天。==每个个体由两个长度为n的二进制向量表示，其中一个表示删除日期的二进制掩码，另一个表示AF事件状态的one-hot编码==。删失向量$V_{\text{censor}}$在个体被删失的时间段中为0，在他们处于风险集中的时间段中为1。事件向量$V_{\text{AF}}$如果在该时间段内发生AF诊断则为1，否则为0。ECG-AI输出长度为n的向量$V_{\text{predict}}$，代表在每个时间段内AF存活的概率。我们的==损失函数最小化了ECG-AI预测的负对数似然==。似然函数分为时间段内幸存个体和发生事件的时间段中的贡献。具体来说，我们最小化以下公式：

$$
L = -\sum \log(L_{\text{survival}} + L_{\text{event}})
$$
其中，

$$
L_{\text{survival}} = 1 - (V_{\text{AF}} * V_{\text{predict}})
$$

$$
L_{\text{event}} = (V_{\text{censor}} * V_{\text{predict}}) + (1 - V_{\text{censor}})
$$

通过这种方式，==删失个体在删失后的时间段中不会对损失做出贡献==（例如，死亡或随访最后时间）。第一个时间段被保留用于记录随访开始前的事件。==该模型为每个时间段预测独立的生存概率（通过sigmoid激活函数）==，因此不假设比例风险，并有助于处理不连续的生存曲线建模。

心电图人工智能==在两个不同的时间尺度（10 秒心电图和 5 年预测生存曲线）之间进行映射==。该映射由==一维卷积神经网络（CNN）==学习，其心电图输入为（5000，12），输出向量为 25 个存活概率，每个时间分段一个。



以下是心电图人工智能的架构概要。简而言之，该模型将 10 秒钟的连续 12 导联心电图波形数据作为第一卷积层的输入。全连接层只接收卷积的心电图波形数据，以生成心房颤动发生时间的估计值（主要）以及年龄、性别和诊断声明中是否存在心房颤动的预测值（次要）。箭头表示各层之间的连接。Conv1D = 一维卷积，MaxPooling1D = 一维最大池化。

## 2. A Novel ECG-Based Deep Learning Algorithm to Predict Cardiomyopathy in Patients With Premature Ventricular Complexes

- PMID: 37480862
-  
- DOI: [10.1016/j.jacep.2023.05.025 ](https://doi.org/10.1016/j.jacep.2023.05.025)

JACC Clin Electrophysiol，Q1，B1，IF8.0，2023



**背景**：早期心室复合搏动（PVCs）是常见的，虽然通常是良性的，但可能导致PVC诱导的心肌病。我们创建了一种深度学习算法，以从12导联心电图（ECG）中预测PVC患者的左心室射血分数（LVEF）下降。

**目标**：本研究旨在评估一种深度学习模型，以预测PVC患者中的心肌病。

**方法**：我们使用了来自5家医院的电子病历，识别出有记录的PVC成人的ECG。内部训练和测试在一家医院进行，外部验证在其他医院进行。主要结果是6个月内首次诊断LVEF降低至40%或以下。数据集中包含383,514个ECG，最终分析了14,241个。我们分析了受试者工作特征曲线下面积（AUC）以及代表性患者的可解释性图，算法预测，PVC负荷和多变量Cox模型中的人口统计学数据，以评估心肌病的独立预测因子。

**结果**：在14,241名患者的队列中（年龄67.6 ± 14.8岁；女性43.8%；白人29.5%，黑人8.6%，西班牙裔6.5%，亚裔2.2%），22.9%的患者在6个月内经历了LVEF降低至40%或以下。模型的预测表现良好，LVEF降低至40%或以下的AUC为0.79（95% CI：0.77-0.81）。梯度加权类别激活图的可解释性框架强调了窦性心律中的QRS波复杂-ST段。在接受成功PVC消融的患者中，绝大多数（89%）患者在消融后LVEF改善，心肌病得到缓解。

**结论**：仅基于12导联ECG的深度学习能够准确预测PVC患者中新发心肌病的发生，与PVC负荷无关。模型预测在性别和种族间表现良好，依赖于窦性心律中的QRS波复杂/ST段，而非PVC的形态。



心电图数据由 XML 文件组成，其中包含 I、II 和 V1-V6 导联的波形数据。其余导联（III、aVF、aVL 和 aVR）被称为 “衍生导联”，因为它们只包含其他导联的信息。应用==巴特沃斯带通滤波器==对心电图波形进行降噪处理，然后再进行==中值滤波==。结果波形数据被绘制成图像，以便使用==二维卷积神经网络==。



我们选择了==最大的可用预训练ResNet模型（ResNet-152）==作为分析的起点。==使用在自然图像上预训练的模型==可以以更少的数据获得更好的性能，同时还需要更少的时间来实现最佳解决方案。

数据基于==组洗牌分割==进行分割，通过确保训练组和测试组中没有患者来==消除数据泄漏的可能性==。我们选择使用Adam优化器，学习率为3e-4，OneCycle学习率计划。模型训练了35个epoch，并在内部测试数据上报告了性能最佳的epoch。所得模型也分别在外部验证数据上进行了评估。==我们使用学习率调度以及持续记录损失和性能指标，以实现模型的最佳拟合。==当模型性能开始恶化时，停止训练（发生过拟合）内部队列是指西奈山医院的患者，而外部队列由外部队列组成。验证数据集从其他4家附属医院的合并患者中获得。

我们使用受试者工作特征曲线下面积（AUROC）和精确召回曲线下面积（AUPRC）指标来评估模型性能，这些指标使用模型输出的未校准概率估计值来生成曲线，这些曲线表示模型区分阳性和阴性的能力。



我们使用梯度加权类激活映射（GradCAM）方法生成类激活映射。这些映射显示了ECG的哪些区域是最负责将模型推向预测的区域。为了进一步评估算法预测，我们提取了模型预测随后LVEF受损的患者，其概率为80%，通过检查急性失血性贫血进行消融术的特异性。然后，由电生理学家进行手动图表审查。我们排除了没有随访的患者-我们通过采集心电图、监护仪和设备询问（包括电描记图），在随访时确定是否存在室性早搏。我们使用配对双尾Student t检验评估接受PVC消融术患者的EF变化。

梯度加权类激活映射（Grad-CAM）是一种用于深度学习模型可解释性的方法，特别适用于卷积神经网络（CNN）。它通过生成热图来帮助理解模型在做出预测时关注的图像区域。

Grad-CAM的工作原理如下：

1. **梯度计算**：对于给定的输入图像和目标类别，计算模型最后一层卷积层的梯度。这些梯度表示了该层特征图对目标类别预测的影响。

2. **加权特征图**：将梯度进行全局平均池化，以获得每个特征图的权重。这些权重表明了特征图在特定类别预测中的重要性。

3. **生成热图**：将权重与相应的特征图相乘并进行加和，得到一个热图。这个热图通常会经过ReLU激活，以突出显示对目标类别有正贡献的区域。

4. **可视化**：将生成的热图叠加在原始图像上，可以直观地观察模型关注的区域，帮助理解模型的决策过程。

Grad-CAM广泛应用于图像分类、物体检测等任务，能够提高深度学习模型的透明度和可解释性。在心电图分析等领域，它同样有助于识别模型关注的ECG特征。

## 3. Automating Detection and Localization of Myocardial Infarction using Shallow and End-to-End Deep Neural Networks

DOI: 10.1016/j.asoc.2020.106383

Applied Soft Computing，Q1，B1，IF7.2，2020



## 4. Deep Learning for Premature Ventricular Contraction-Cardiomyopathy Are We Digging Deep Enough



## 5. Deep Learning of Electrocardiograms in Sinus Rhythm From US Veterans to Predict Atrial Fibrillation



## 6. Development and validation of machine learning algorithms based on electrocardiograms for cardiovascular diagnoses at the population level



## 7. Machine Learning for Myocardial Infarction Compared With Guideline-Recommended Diagnostic Pathways.



## 8. Machine Learning for the ECG Diagnosis and Risk Stratification of Occlusion Myocardial Infarction at First Medical Contact



## 9. New ECG Criteria for Acute Myocardial 



## 10. A deep learning algorithm for detecting acute myocardial

看过

## 11. Artificial intelligence fully automated myocardial strain quantification for risk stratification following acute myocardial infarction

看过

## 12. Artificial intelligence-enabled electrocardiogram screens low left ventricular ejection fraction with a degree of confidence

看过

## 13. Machine learning for diagnosis of myocardial infarction using cardiac troponin concentrations



## 14. Machine learning for ECG diagnosis and risk stratification of occlusion myocardial infarction

看过

## 15. Bimodal Masked Autoencoders with Internal Representation Connections for Electrocardiogram Classification

看过



## 16. Self-supervised representation learning from 12-lead ECG data(待定，好像质量一般)



